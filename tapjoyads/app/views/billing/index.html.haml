- @page_title = 'Billing'

.box-full
  .right= button_to 'Add funds', add_funds_billing_path
  %h2 Billing Summary
  .clear
  .left
    Current Balance:
    = number_to_currency(@current_balance/100.0)
  .right
    Last Payment:
    = number_to_currency(@last_payment/100.0)
  .centered
    Last Payout:
    = number_to_currency(@last_payout/100.0)
  .clear
  %hr/
.box-full
  - unless @statements.blank?
    #billing-date-range
      %form#change_date{:method => 'get'}
        = collection_select("billing", "start_date", @statements, :to_date, :to_mm_yyyy, :selected => @start_date)
        to
        = collection_select("billing", "end_date", @statements, :to_date, :to_mm_yyyy, :selected => @end_date)
        = submit_tag "go"
    #billing-summary
      %table
        %thead
        %tbody
          %tr
            %th &nbsp;
            %th{:colspan => 2} Earnings
            %th{:colspan => 2} Advertising Cost
            %th Balance
          %tr.subheader
            %th &nbsp;
            %th Earnings
            %th Payouts
            %th Orders
            %th Spending
            %th &nbsp;
          = render :partial => 'statement', :collection => @selected_statements, :locals => {:format => :table}
    = button_to 'Export', {:method => 'GET', :action => 'export', :billing => {:start_date => @start_date, :end_date => @end_date} }
  - else
    No Statements available

- content_for :page_javascript do
  :plain
    $(function() {
      $('#change_date input[type=submit]').click(function() {
        // TODO: ajax call instead of refresh
      })
    });

