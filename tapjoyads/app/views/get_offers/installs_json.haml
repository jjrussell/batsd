:ruby
  offer_array = []
  @offer_list.each_with_index do |offer, index|
    hash                    = {}
    hash["Cost"]            = visual_cost(offer)
    hash["isFree"]          = offer.is_free?
    hash["Amount"]          = @currency.get_visual_reward_amount(offer, params[:display_multiplier])
    hash["IconURL"]         = offer.video_offer? ? offer.video_icon_url : offer.get_icon_url(:source => :cloudfront, :size => '57')
    hash["IconURLMedium"]   = offer.video_offer? ? offer.video_icon_url : offer.get_icon_url(:source => :cloudfront, :size => '114')
    hash["Name"]            = offer.name
    hash["RedirectURL"]     = get_click_url(offer, :offerwall_rank => (index + 1))
    hash["StoreID"]         = offer.store_id_for_feed
    hash["Payout"]          = @currency.get_publisher_amount(offer)
    hash["Type"]            = offer.item_type
    hash["FullScreenAdURL"] = get_fullscreen_ad_url(offer) if params[:source] == 'featured'
    hash["PapayaUserCount"] = number_with_delimiter(@papaya_offers[offer.id]) if @device.is_papayan? && @show_papaya && @papaya_offers.include?(offer.id)
    hash["WifiOnly"]        = offer.wifi_only? if @show_wifi_only
    hash["ActiveGamers"]    = offer.app_formatted_active_gamer_count if params[:source] == 'tj_games'
    offer_array << hash
  end

  obj                      = {}
  obj["OfferArray"]        = offer_array
  obj["Message"]           = "Install one of the apps below to earn #{@currency.name}"
  obj["CurrencyName"]      = @currency.name
  obj["TapPoints"]         = @tap_points if @tap_points.present?
  obj["MoreDataAvailable"] = @more_data_available if @more_data_available > 0

= raw "#{params[:callback].gsub(/\W/, '')}(" if params[:callback].present?
= raw obj.to_json
= raw ")" if params[:callback].present?
