= form_for [ :tools, @generic_offer ], :html => { :class => 'tjform', :multipart => true } do |f|
  %table
    %tr
      %th= label_tag 'Partner'
      %td
        = @generic_offer.partner.name
        = f.hidden_field :partner_id
    %tr
      %th= f.label :name
      %td
        = f.text_field :name, :size => 50
        = error_message_on @generic_offer, :name

    %tr
      %th
        = f.label :name, 'Prerequisite'
        #help_prerequisite.help ?
      %td
        - offer_options = @generic_offer.partner.offers.sort { |a, b| a.name <=> b.name }.reject { |offer| offer.id == @generic_offer.id }.collect { |offer| [ "#{offer.name} -#{offer.name_suffix}-#{offer.item_type}", offer.id ] }
        - offer_options = [ [ "None", "" ] ] + offer_options if ((permitted_to?(:edit, :dashboard_statz) || prerequisite_offer_id.blank?))
        = f.select :prerequisite_offer_id, offer_options
        = error_message_on @generic_offer, :prerequisite_offer_id
    %tr
      %th
        = f.label :name, 'Negative Prerequisite'
        #help_negative_prerequisite.help ?
      %td
        - offer_options = @generic_offer.partner.offers.sort { |a, b| a.name <=> b.name }.reject { |offer| offer.id == @generic_offer.id }.collect { |offer| [ "#{offer.name} -#{offer.name_suffix}-#{offer.item_type}", offer.id ] }
        - offer_options = [ [ "None", "" ] ] + offer_options if ((permitted_to?(:edit, :dashboard_statz) || negative_prerequisite_offer_id.blank?))
        = f.select :negative_prerequisite_offer_id, offer_options
        = error_message_on @generic_offer, :negative_prerequisite_offer_id

    %tr
      %th= f.label :category
      %td
        = f.select :category, GenericOffer::CATEGORIES, :include_blank => true
        = error_message_on @generic_offer, :category
        .inline_help Classify urls that redirect to video ads outside of our system (such as youtube or vimeo) as Non-Native Video
    %tr
      %th= f.label :price
      %td
        = f.currency_field :price
        = error_message_on @generic_offer, :price
    %tr
      %th= f.label :url
      %td
        = f.text_field :url, :size => 50
        = error_message_on @generic_offer, :url
    - if !@generic_offer.new_record?
      %tr
        %th= label_tag "Current Icon", "Current Icon"
        %td= image_tag @generic_offer.primary_offer.get_icon_url, :size => '57x57'
    %tr
      %th= label_tag :icon, @generic_offer.new_record? ? 'Upload Icon' : 'Upload New Icon'
      %td= file_field_tag :icon
    %tr
      %th= f.label :instructions
      %td= f.text_area :instructions
    %tr
      %td{ :colspan => 2 }= f.submit @generic_offer.new_record? ? 'Create Generic Offer' : 'Update Generic Offer'
