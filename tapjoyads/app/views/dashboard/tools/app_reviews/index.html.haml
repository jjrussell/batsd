- @page_title = 'All App Reviews'

%h1
  All App Reviews
  - if @app_metadata.present?
    for #{@app_metadata.name}
  - if @author.present?
    by #{@app_reviews[0].author_name}

- if @app_metadata.present?
  = link_to "[Add new review for #{@app_metadata.name}]", new_tools_app_review_path(:app_metadata_id => @app_metadata.id)
- if @app_metadata.present? || @author.present?
  = link_to "[All app reviews]", tools_app_reviews_path

%br

%table#app_reviews_table.tablesorter
  %thead
    %tr
      %th App Name
      %th Reviewer
      %th Platform
      %th Review Text
      %th Rating
      %th Bury Votes
      %th Helpful Votes
      %th
      %th
  %tbody
    - @app_reviews.each do |app_review|
      %tr
        %td= link_to(app_review.app_metadata_name, tools_app_reviews_path(:app_metadata_id => app_review.app_metadata_id))
        %td= link_to(app_review.author_name, tools_app_reviews_path(:author_id => app_review.author_id, :author_type => app_review.author_type))
        %td= app_review.platform
        %td= app_review.text
        %td= app_review.user_rating
        %td= app_review.bury_votes_count
        %td= app_review.helpful_votes_count
        %td= link_to('Edit', edit_tools_app_review_path(app_review))
        %td= link_to('Delete', tools_app_review_path(app_review), :method => :delete, :confirm => "Delete review?")
= will_paginate(@app_reviews)

%br
= link_to('Add New Review', new_tools_app_review_path)

- content_for :page_javascript do
  :plain
    $(function() {
      $("#app_reviews_table").tablesorter({
        widgets: ['zebra'],
        headers: {
          3: { sorter: false },
          4: { sorter: false },
          7: { sorter: false },
          8: { sorter: false }
        }
      });
    });
