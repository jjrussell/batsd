- @page_title = 'Sdb Metadata'

%h1 Sdb Metadata

As of: #{Time.zone.now.to_s(:pub_ampm_sec)}
%br
%br
Number of domains: #{@metadata.size}

%table#metadata.tablesorter
  %thead
    %tr
      %th Domain Name
      %th Domain Size (bytes)
      %th Item count
      %th Attribute name count
      %th Attribute value count
  %tbody
    - @metadata.each do |domain_name, metadata|
      %tr
        %td= domain_name
        %td= number_with_delimiter(metadata[:attribute_names_size_bytes] + metadata[:attribute_values_size_bytes] + metadata[:item_name_size_bytes])
        %td= number_with_delimiter(metadata[:item_count])
        %td= number_with_delimiter(metadata[:attribute_name_count])
        %td= number_with_delimiter(metadata[:attribute_value_count])

- content_for :page_javascript do
  :plain
    $(function() {
      $.tablesorter.addParser({
        id: 'name-column',
        is: function(s) { return false; },
        type: 'text',
        format: function(s) {
          return s.replace(/-/g, '_');
        }
      });
      $.tablesorter.addParser({
        id: 'formatted-number-column',
        is: function(s) { return false; },
        type: 'numeric',
        format: function(s) {
          return s.replace(/,/g, '');
        }
      });
      $("#metadata").tablesorter({
        widgets: ['zebra'],
        headers: {
          0: { sorter: 'name-column' },
          1: { sorter: 'formatted-number-column' },
          2: { sorter: 'formatted-number-column' },
          3: { sorter: 'formatted-number-column' },
          4: { sorter: 'formatted-number-column' }
        },
        sortList: [ [1, 1] ]
      });
    });

- content_for :page_styles do
  :plain
    table.tablesorter {
      border-collapse: separate;
    }

    table.tablesorter thead tr .header {
      background-position: right bottom;
    }
