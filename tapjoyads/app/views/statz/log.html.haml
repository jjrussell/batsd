- @page_title = "Activity log for offer: #{@offer.name}"

.icon= image_tag(@offer.get_icon_url, :size => '57x57')
%h1 Activity log for #{@offer.name}

%table#activities_table.tablesorter
  %thead
    %tr
      %th User
      %th Object Type
      %th Before state
      %th After state
      %th Created
      %th Controller
      %th Action
      %th Request id
  %tbody
    - @activities.each do |activity|
      %tr
        %td= activity.user
        %td= activity.object_type
        %td
          - activity.before_state.each do |key, value|
            - next if key == 'updated-at' || key == 'updated_at'
            %p
              #{key}:
              %b= value
        %td
          - activity.after_state.each do |key, value|
            - next if key == 'updated-at' || key == 'updated_at'
            %p 
              #{key}:
              %b= value
        %td= activity.created_at.to_s(:db)
        %td= activity.controller
        %td= activity.action
        %td{:style => 'font-size: 80%'}= activity.request_id
      
- content_for :page_javascript do
  :plain
    $(function() {
      $("#activities_table").tablesorter({widgets: ['zebra'],
        sortList: [ [4, 1] ]
      });
    });
  
- content_for :page_styles do
  :plain
    .icon {
      float: left;
      padding-bottom: 20px;
    }
    