- @load_facebook = false
- @load_facebook_sdk = false

- @page_title = "#{t('text.instructions.title')} - #{@offer.name}"
- amount_and_currency = content_tag(:b, t('text.instructions.amount_and_currency', :amount => @currency.get_visual_reward_amount(@offer, params[:display_multiplier]), :currency => @currency.name))

.ui-joy-mask
  .ui-joy-panel#panel
    .earn-block
      .reward
        %span.earn= t('text.instructions.earn_currency_html', :amount_and_currency => '')
        %span.big= @currency.get_visual_reward_amount(@offer, params[:display_multiplier])
        %span.points= @currency.name
        %span.free= visual_cost(@offer)

    .grey-box
      .app-logo
        = image_tag @offer.get_icon_url(:source => :cloudfront, :size => '57')
      .heading= @offer.name
    .instructions
      .content
        %ul.steps
          :plain
            #{instruction_list(@offer.instructions)}
    .padit
      .reward-button.click-action
        %span= t('text.instructions.earn_currency_html', :amount_and_currency => amount_and_currency)
    #adsby
      %span#presented_by
        = t('text.instructions.presented_by', :default => 'Presented By')
      #logo


%iframe#loader{ :style => 'display: none', :height => '0', :width => '0' }

- content_for :page_javascript do
  :plain
    $(function($){
      var ctURL = #{@click_tracking_urls.first.to_json.html_safe},
          src = '<iframe src="'+ ctURL +'" width="1" height="1" frameborder="0" style="display:none"></iframe>';
      if (ctURL) {
        $("body").append(src);
      }
      $('.click-action').click(function(e) {
        var cURL = #{@conversion_tracking_urls.first.to_json.html_safe},
            src = '<iframe src="'+ cURL +'" width="1" height="1" frameborder="0" style="display:none"></iframe>';
        if (cURL) {
          $("body").append(src);
        }
        var phUrl = #{@protocol_handler_url.to_json.html_safe},
            fallbackUrl = #{@complete_action_url.to_json.html_safe};
        var appversion = navigator.appVersion,
            idevice = (/iphone|ipad|ipod/gi).test(appversion),
            android = (/android/gi).test(appversion);

        if (idevice || android) {
          $('#loader').attr('src', phUrl);
          window.setTimeout(function(){
            window.location.replace(fallbackUrl);
          }, 500);
        }
        else {
          window.location.href = fallbackUrl;
        }
      });
    });
- content_for :page_styles do
  :plain
    * {
      margin: 0;
      padding: 0;
      outline: 0;
      font-weight: inherit;
      font-style: inherit;
      font-size: inherit;
      font-family: inherit;
      vertical-align: baseline;
      text-decoration: none;
    }

    body {
      margin-bottom: 10px;
      color: #004E09;
    }

    img {
      border: 0;
    }

    #offers {
      margin: 10px 3%;
      background: white;
      border: 1px solid #d5d5d5;
      -moz-border-radius: 10px;
      -webkit-border-radius: 10px;
      padding: 10px;
    }

    .amount {
      color: rgb(0, 136, 16);
    }

    #privacy a {
      font-size: 75%;
      color: #004E09;
    }

    #adsby {
      margin-top: 2px;
      padding-left: 85px;
    }

    #privacy {
      float: left;
      margin-left: 5%;
      text-decoration: underline;
    }

    .clear {
      clear: both;
    }

    .hidden {
      display: none;
    }

    #header img {
      float: left;
      margin: 0 10px 0 0;
    }

    #header #action_name {
      height: 57px;
      display: table-cell;
      vertical-align: middle;
      padding-bottom: 10px;
    }

    #header {
      border-bottom: 2px solid;
    }

    #action_instructions {
      clear: both;
      margin-top: 10px;
      border-bottom: 2px solid;
    }

    .important {
      font-weight: bold;
      margin: 10px 0;
    }
    
    .instructions p {
      margin-bottom: 10px;
    }

    #footer {
      margin: 10px 0 0;
    }

    .continue {
      font-size: 24px;
    }

    #adsby { margin-top: 2px; }
    #adsby span { display: inline-block; font-size: 13px; text-decoration: none; vertical-align: top; }
    #adsby #logo { background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAVCAMAAADl7ZdoAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5QTg5Q0VGREY2MUUxMUUxOTJENUZCMTY3RDBBRjQwNSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5QTg5Q0VGRUY2MUUxMUUxOTJENUZCMTY3RDBBRjQwNSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjlBODlDRUZCRjYxRTExRTE5MkQ1RkIxNjdEMEFGNDA1IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjlBODlDRUZDRjYxRTExRTE5MkQ1RkIxNjdEMEFGNDA1Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+eDSZzQAAAUpQTFRFiYmJi4uLmZmZ8PDwwcHB7+/vxMTEtLS0srKykpKSkJCQ5ubmx8fHioqK7Ozsk5OTn5+f8/Pz09PTmJiY8vLy6Ojo2NjY+fn5/v7+6urq5OTkmpqa3Nzc/Pz86enpjIyM7e3tpKSkjo6O8fHx7u7uxcXFzc3NzMzMu7u7q6urqKiom5ubp6en1tbWz8/P+/v739/frKysv7+/2dnZqampkZGR0NDQl5eX6+vrs7OzwMDAubm5+Pj49fX1pqamwsLCyMjI+vr63d3dysrK1NTUvr6+jY2Nnp6e9PT0oKCgycnJlZWVtra2vLy8nJyc4+PjtbW1oaGhr6+vlJSUoqKipaWl9/f3nZ2d3t7eo6Ojw8PDy8vL0tLS1dXV/f3919fXj4+Pzs7O5+fnuLi4lpaWvb29t7e34eHh9vb2ra2t2traxsbGrq6u////49ha4AAAAG50Uk5T/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wCgBTwzAAABzUlEQVR42oyT1XLjQBBFryzZQsvMjDFTYoeZmZeZ6f7/645dtcnG69T6lKpb1ToPPdMtsKDcJhwOR70+jA8J7PIhWDgGIEmSiBlpDGyM2xrqs7Yspz2wgk6nLMvDMHxELm6O208xGOYFN+L8L3iOK/kN2YTho89Va6gx+fvnwZom09R6Ue7U9tUil7Rz2ovqAV4D+RCpwMv0PPLAVhxwA126UKMlzoTDVA4tLqMaBcNrZwdkF2rUC39Bd/viuM624ElpKPn2EDYl2Mt4HzGkECG6iZDtBMpx3NBGgDOYo4lAxItnfpwxKCFr4WUZixzZgmIG50fQOIsqL6BwA+q3vLvQw5UoedqvUPFKsTs7icyqBc/RJXq8gbadl9ImPkUtJMKHOBWf+1B5Z5dEB7aBvRw+RnQxqOumaKhBOSDeGytMu5GJ3dt20iRjg+LmTuED9M7XVfILKmRwZv1tivS9wwnv7b8oY3+Uc2j+KaWWYDgn2x3lB0MtSzFw8dM1pHTqBfycbJNPfmGMeT8fs9s5GCeuKo7XlREvtpMrfNQOoy9WwTW6svGt+re0K2ZJXqI8lV2Cp5OtoB+cys7qoyX0cyqbZlfX57Ym/Q2/BRgAxOn0Cwpi9kwAAAAASUVORK5CYII=) no-repeat; }
    #adsby #logo { display: inline-block; width: 45px; height: 21px; margin-bottom: 2px;}
