- @page_title = 'Ad Preview'

#previews
  - publisher_app_id = "2349536b-c810-47d7-836c-2cd47cd3a796" # TapDefense
  - if @offer.featured?
    - width, height = @image_size.split('x')
    - screen_height = height.to_i + Offer::FEATURED_AD_BUTTON_HEIGHT
    = "Featured ad: (#{width}x#{screen_height})"
    %div{:class => "img#{@dimensions}"}
      - if @show_generated_ads
        = image_tag(@offer.fullscreen_ad_image_url(publisher_app_id, true, :image_size => @image_size), :class => 'preview', :alt => '')
      - else
        = render :partial => "no_icon"
  - else
    - if @offer.rewarded? # show offer wall ad
      Marketplace ad:
      %div.img320x76
        - if @show_generated_ads
          = image_tag(@offer.get_offers_image_url(publisher_app_id, true), :class => 'preview', :alt => '')
        - else
          = render :partial => "no_icon"

    - if @offer.display_banner_ads?
      - Offer::DISPLAY_AD_SIZES.each_with_index do |size, index|
        = "#{size} banner ad:"
        %div{:class => "img#{size}"}
          - if @show_generated_ads
            - width, height = size.split("x").collect{|x|x.to_i}
            = image_tag(@offer.display_ad_image_url(publisher_app_id, width, height, nil, nil, true), :class => 'preview', :alt => '')
          - else
            = render :partial => "no_icon"

  - if @offer.rewarded? && !@offer.featured?
    .banner_ad_notes
      *Banner ads for rewarded installs are only displayed for free apps where the app name is 30 characters or less, and where the conversion rate is 30% or more.

  - else
    .banner_ad_notes
      *To provide custom creatives for your non-rewarded ads, please contact
      = succeed '.' do
        = mail_to "support@tapjoy.com"
      Please ensure images have correct dimensions. Custom ads for non-rewarded installs are only displayed for free apps.

- content_for :page_javascript do
  :plain
    $(function($){
      $("img.preview").load(function() {
        this.setAttribute("style", "display: inline; border: 1px solid;");
      });
    });

- content_for :page_styles do
  :plain
    #previews {
      text-align: center;
    }

    .banner_ad_notes {
      font-size: 12px;
    }

    img.preview {
      display: none;
    }

  - (Offer::DISPLAY_AD_SIZES + Offer::FEATURED_AD_SIZES + %w(320x480 320x76)).each do |size|
    - width, height = size.split("x")
    - height_with_buttons = height.to_i + Offer::FEATURED_AD_BUTTON_HEIGHT
    - if @show_generated_ads # show spinner while images are loading
      :plain
        div.img#{width}x#{height} {
          background-image: url('/images/spinner.gif');
          background-repeat: no-repeat;
          background-position: center;
        }
    :plain
      div.img#{width}x#{height} {
        height: #{height_with_buttons}px;
        margin-bottom: 10px;
        margin-top: 5px;
        min-width: #{width}px;
      }
