- @page_title = 'Apps'
- is_iphone = @app.platform=='iphone'
- app_store_name = is_iphone ? 'AppStore' : 'Marketplace'

= render :partial => 'shared/carousel', :locals => {:objects => current_partner_apps, :object => @app}
= render :partial => 'actions', :locals => {:app => @app}
.new_app_button= button_to "Add App", new_app_path

#apps_main
  - unless @app.nil?
    %h2= @app.name
    - form_for @app do |f|
      = f.hidden_field :store_id
      %table.editable
        %tbody
          %tr
            %th
              Application state
              #help_application_state.help ?
            %td
              = select_tag "state", options_for_select(['Not live', 'Live'].zip(%w(not_live, live))), :id => "app_state"
          %tr
            %th
              Platform
              #help_platform.help ?
            %td= is_iphone ? 'iPhone' : 'Android'
          %tr
            %th
              Name
              #help_name.help ?
            %td
              = f.text_field :name, :size => 50
              = button_to_function "Search", "search()", :class => 'search'
              -if @app.errors.on :name
                = error_message_on @app, :name
              #search_results
                = image_tag 'load-circle.gif', :class => 'load-circle'
          %tr
            %th
              App ID
              #help_app_id.help ?
            %td= @app.id
          %tr
            %th
              Integrated?
              #help_integrated.help ?
            - if @integrated
              %td.integrated YES
            - else
              %td.not_integrated NO
          %tr.app_data
            %th Store ID
            %td= link_to(@app.store_id, @app.final_store_url)
          %tr.app_data
            %th Icon
            %td#app_icon= image_tag(@app.get_icon_url(request.protocol), :size => '57x57', :alt => 'icon')
          %tr.app_data
            %th
              Price
              #help_price.help ?
            %td
              = f.currency_field :price, {}, :size => 10
              - if @app.errors.on :price
                = error_message_on @app, :price
              App ID
          %tr.app_data
            %th Description
            %td
              #app_description= (@app.description || '').gsub("\n", '<br>')
          %tr
            %td
            %td= f.submit 'Update'

.hidden
  #help_application_state_content{:name => 'Application State'}
    %li Not live: The app has not been submitted or approved yet.
    %li Live: The app has been approved, and is currently listed in the #{app_store_name}.
  #help_platform_content{:name => 'Platform'}
    Platform on which this app runs.
  #help_name_content{:name => 'Name'}
    App name
  #help_app_id_content{:name => 'App ID'}
    App ID. Use this when integrating.
  #help_description_content{:name => 'Description'}
    App description
  #help_store_url_content{:name => 'Store URL'}
    - if is_iphone
      %li e.g. http://itunes.apple.com/app/<b>app-name</b>/id<b>123456789</b>
    - else
      %li e.g. market://search?q=<b>123456789</b>.
  #help_icon_content{:name => 'Icon'}
    We automatically retrieve the icon that is currently in the #{app_store_name}
  #help_price_content{:name => 'Price'}
    Price of the app on the #{app_store_name}
  #help_integrated_content{:name => 'Integrated'}
    Integration status - shows if the app has connected with our servers within the last 24-hours.

- content_for :page_head, stylesheet_link_tag('apps')
- content_for :included_javascripts, javascript_include_tag('tapjoy/apps')
